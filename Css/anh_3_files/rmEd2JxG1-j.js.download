;/*FB_PKG_DELIM*/

__d("AdsDataAtomPerfProfiler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.addFluxActionDispatchInfo=function(a,b){this.$1.set(String(a),b)};b.getFluxActionDispatchInfo=function(a){return this.$1.get(String(a))};return a}();b=new a();f["default"]=b}),66);
__d("MWPMessageRowCalculateStatusV2.react",["GenderConst","I64","MAWThreadCutover","MWClickedMessageContext.react","MWMessageDeliveryStatus","MWPActor.react","MWPThreadCapabilitiesContext","ReQL","ReQLSuspense","getLSMediaContactProfilePictureUrl","gkx","react","useGetMediaGroupInformation","useMWIsReadReceiptsDisabledForThread","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;j||(j=d("react"));b=j;var k=b.useEffect,l=b.useMemo,m=b.useState,n=b.c,o={type:"NoneStatus"},p={type:"Loading"},q={type:"RetriableError"},r={type:"Error"},s={type:"Sending"},t={type:"Sent"},u={type:"Delivered"};function a(a){var b=a.children,e=a.isBroadcastChannel,g=e===void 0?!1:e;e=a.isBroadcastThread;var j=a.isLargeGroup,m=a.isSecureGroupThread,n=a.isSecureThread,w=a.message,y=a.nextMessage,z=d("MWPActor.react").useActor(),A=(h||(h=c("useReStore")))(),B=(i||(i=d("I64"))).equal(z,w.senderId),C=y!=null&&!(i||(i=d("I64"))).equal(z,y.senderId),D=w.isUnsent,E=d("MWPThreadCapabilitiesContext").useMWPThreadCapabilitiesContext();E=E.seenCountV2Enabled;var F=!w.isUnsent&&E,G=y==null;E=c("useMWIsReadReceiptsDisabledForThread")(w.threadKey)&&c("gkx")("24094");n=c("useGetMediaGroupInformation")(w,n);var H=c("MWClickedMessageContext.react").useHook(),I=H.clickedMessageId,J=H.fetchMessageSeenCount,K=H.hasError;H=H.isLoading;var L=d("ReQLSuspense").useFirst(function(){return F?d("ReQL").fromTableAscending(A.tables.community_chat_message_seen_count,["seenCount"]).getKeyRange(w.threadKey,w.messageId):d("ReQL").empty()},[A,F,w.threadKey,w.messageId],f.id+":110");k(function(){g===!0&&G&&J(w.threadKey,w.messageId)},[J,w.messageId,w.threadKey,G,g,B]);var M=v(a,function(a){return!G&&a.length===0},[G]),N=x(function(){return d("ReQL").fromTableDescending(A.tables.participants.index("threadKeyReadWatermarkTimestampMs"),["contactId"]).getKeyRange(w.threadKey).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,z)}).take(1)},function(a){return a.length>0},[w.threadKey,z]).length>0,O=x(function(){return d("ReQL").fromTableDescending(A.tables.participants.index("threadKeyReadWatermarkTimestampMs"),["readWatermarkTimestampMs","contactId"]).getKeyRange(w.threadKey).bounds({gte:d("ReQL").key(w.timestampMs)}).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,z)}).take(1)},function(a){return N&&a.length>0},[w.timestampMs,w.threadKey,z,N]),P=O.length>0;O=x(function(){return d("ReQL").fromTableDescending(A.tables.participants.index("threadKeyDeliveredWatermarkTimestampMs"),["contactId"]).getKeyRange(w.threadKey).bounds({gte:d("ReQL").key(w.timestampMs)}).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,z)}).take(1)},function(a){return a.length>0||P},[w.threadKey,w.timestampMs,P,z]).length>0;var Q=v(a,function(a){return P&&a.length===0},[P]),R=l(function(){var a;return d("MWMessageDeliveryStatus").seenCount((i||(i=d("I64"))).to_int32((a=L==null?void 0:L.seenCount)!=null?a:(i||(i=d("I64"))).zero))},[L==null?void 0:L.seenCount]),S=l(function(){return d("MWMessageDeliveryStatus").seenHead(M)},[M]),T=l(function(){return d("MWMessageDeliveryStatus").seenHead(Q)},[Q]);if(w.isAdminMessage)return b(o);if(e)if(!F){if(!B||y!=null||D)return b(o)}else{if(I!==w.messageId)return b(o);if(H)return b(p);return K?b(q):L!=null?b(R):b(p)}if(!B){if(m&&!c("gkx")("3265")||j)return b(o);return g===!0?L!=null?b(R):b(o):M.length>0?a.children(S):a.children(o)}if(B&&G&&g&&(L!=null&&(i||(i=d("I64"))).to_int32(L.seenCount)>0))return b(R);if(C&&m)return b(o);if((i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(0)))return b(o);if((i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(4))||(i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(5)))return b(r);if((i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(1)))return b(s);if((i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(6)))return b(t);if(j)if(y!=null||D)return b(o);else if((i||(i=d("I64"))).equal(w.sendStatusV2,(i||(i=d("I64"))).of_int32(2)))return b(u);if(P&&!E)return Q.length>0?b(T):b(o);if(n!=null&&n.isMediaGroupLastMessage)if(n.hasAllMessagesSent)return b(t);else return b(s);return O?b(u):b(t)}a.displayName=a.name+" [from "+f.id+"]";function v(a,b,e){var g=n(25),j=(h||(h=c("useReStore")))(),k=d("MWPActor.react").useActor(),l=a.message,m=a.nextMessage,o=c("useMWIsReadReceiptsDisabledForThread")(l.threadKey)&&c("gkx")("24094"),p;g[0]!==a.isSecureThread||g[1]!==l.threadKey?(p=a.isSecureThread?(i||(i=d("I64"))).to_string(l.threadKey):void 0,g[0]=a.isSecureThread,g[1]=l.threadKey,g[2]=p):p=g[2];a=d("MAWThreadCutover").useGetCutoverSecureThreadKey(p);g[3]!==a?(p=a!=null?(i||(i=d("I64"))).of_string(a):null,g[3]=a,g[4]=p):p=g[4];var q=p;g[5]!==m||g[6]!==l.timestampMs||g[7]!==l.threadKey||g[8]!==j.tables.participants||g[9]!==j.tables.contacts||g[10]!==k||g[11]!==q?(a=function(){var a=m!=null?{gte:d("ReQL").key(l.timestampMs),lt:d("ReQL").key(m.timestampMs)}:{gte:d("ReQL").key(l.timestampMs)};a=d("ReQL").fromTableAscending(j.tables.participants.index("threadKeyReadWatermarkTimestampMs"),["contactId","nickname","readActionTimestampMs"]).getKeyRange(l.threadKey).bounds(a).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,k)});var b={gte:d("ReQL").key(l.timestampMs)},c=q!=null?d("ReQL").fromTableAscending(j.tables.participants.index("threadKeyReadWatermarkTimestampMs"),["contactId","nickname","readActionTimestampMs"]).getKeyRange(q).bounds(b).filter(function(a){return!(i||(i=d("I64"))).equal(a.contactId,k)}):d("ReQL").empty();return d("ReQL").union(a,c).map(function(a){var b=d("ReQLSuspense").toArray(c,f.id+":448").some(function(b){return(i||(i=d("I64"))).equal(b.contactId,a.contactId)});if(b)return;return a}).filter(Boolean).map(function(a){var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(j.tables.contacts,["id","name","profilePictureFallbackUrl","profilePictureUrl","profilePictureUrlExpirationTimestampMs"]).getKeyRange(a.contactId),f.id+":463");return[a,b]})},g[5]=m,g[6]=l.timestampMs,g[7]=l.threadKey,g[8]=j.tables.participants,g[9]=j.tables.contacts,g[10]=k,g[11]=q,g[12]=a):a=g[12];p=m==null?void 0:m.timestampMs;var r=m==null,s=q==null,t;g[13]!==j||g[14]!==l.threadKey||g[15]!==l.timestampMs||g[16]!==p||g[17]!==r||g[18]!==s||g[19]!==k||g[20]!==e?(t=[j,l.threadKey,l.timestampMs,p,r,s,k].concat(e),g[13]=j,g[14]=l.threadKey,g[15]=l.timestampMs,g[16]=p,g[17]=r,g[18]=s,g[19]=k,g[20]=e,g[21]=t):t=g[21];p=x(a,b,t);g[22]!==o||g[23]!==p?(r=o?[]:p.map(w).filter(Boolean),g[22]=o,g[23]=p,g[24]=r):r=g[24];return r}function w(a){var b,e=a[0];a=a[1];if(a==null)return;return{gender:c("GenderConst").UNKNOWN_SINGULAR,id:(i||(i=d("I64"))).to_string(a.id),imageSrc:c("getLSMediaContactProfilePictureUrl")(a),name:(b=e.nickname)!=null?b:a.name,timestamp:i.to_float(e.readActionTimestampMs)}}function x(a,b,c){var e=m(void 0),g=e[0];e=e[1];c=d("ReQLSuspense").useArray(function(){return g!=null?d("ReQL").empty():a()},[].concat(c,[g]),f.id+":523");b(c)&&g==null&&e(c);return g!=null?g:c}g["default"]=a}),98);